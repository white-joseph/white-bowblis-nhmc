source("C:/Repositories/white-bowblis-nhmc/regressions/did_twfe.R", echo = TRUE)
gc()
gc()
library(dplyr)
library(fixest)
library(readr)
panel_fp <- "C:/Repositories/white-bowblis-nhmc/data/clean/panel.csv"
keep_cols <- c(
"cms_certification_number","year_month","quarter",
"event_time","treatment","post", "anticipation",
"government","non_profit", "chain", "beds",
"occupancy_rate", "pct_medicare","pct_medicaid",
"cm_q_state_2", "cm_q_state_3", "cm_q_state_4",
"rn_hppd","lpn_hppd","cna_hppd","total_hppd"
)
df <- read_csv(panel_fp, show_col_types = FALSE, col_select = all_of(keep_cols)) %>%
mutate(
year_month = as.character(year_month),
cms_certification_number = as.factor(cms_certification_number)
)
library(dplyr)
library(fixest)
library(readr)
panel_fp <- "C:/Repositories/white-bowblis-nhmc/data/clean/panel.csv"
keep_cols <- c(
"cms_certification_number","year_month","quarter",
"event_time","treatment","post", "anticipation",
"government","non_profit", "chain", "beds",
"occupancy_rate", "pct_medicare","pct_medicaid",
"cm_q_state_2", "cm_q_state_3", "cm_q_state_4",
"rn_hppd","lpn_hppd","cna_hppd","total_hppd"
)
df <- read_csv(panel_fp, show_col_types = FALSE, col_select = all_of(keep_cols)) %>%
mutate(
year_month = as.character(year_month),
cms_certification_number = as.factor(cms_certification_number)
)
View(df)
library(dplyr)
library(fixest)
library(readr)
panel_fp <- "C:/Repositories/white-bowblis-nhmc/data/clean/panel.csv"
keep_cols <- c(
"cms_certification_number","year_month","quarter",
"event_time","treatment","post", "anticipation",
"time", "time_treated",
"government","non_profit", "chain", "beds",
"occupancy_rate", "pct_medicare","pct_medicaid",
"cm_q_state_2", "cm_q_state_3", "cm_q_state_4",
"rn_hppd","lpn_hppd","cna_hppd","total_hppd"
)
df <- read_csv(panel_fp, show_col_types = FALSE, col_select = all_of(keep_cols)) %>%
mutate(
year_month = as.character(year_month),
cms_certification_number = as.factor(cms_certification_number)
)
View(df)
source("C:/Repositories/white-bowblis-nhmc/regressions/did_event_study.R", echo = TRUE)
View(df)
# set never-treated cohorts to Inf
df$time_treated[is.na(df$time_treated)] <- Inf
View(df)
# example feols call
sun_ab_did = feols(total_hppd ~ controls + sunab(time_treated, time) | cms_certification_number + time, df)
controls <- paste(
"government + non_profit + chain + beds +",
"occupancy_rate + pct_medicare + pct_medicaid +",
"cm_q_state_2 + cm_q_state_3 + cm_q_state_4"
)
sun_ab_did = feols(total_hppd ~ controls + sunab(time_treated, time) | cms_certification_number + time, df)
sun_ab_did = feols(total_hppd ~ government + non_profit + sunab(time_treated, time) | cms_certification_number + time, df)
gc()
source("C:/Repositories/white-bowblis-nhmc/regressions/did_event_study.R", echo = TRUE)
source("C:/Repositories/white-bowblis-nhmc/regressions/did_event_study.R", echo = TRUE)
source("C:/Repositories/white-bowblis-nhmc/regressions/did_event_study.R", echo = TRUE)
source("C:/Repositories/white-bowblis-nhmc/regressions/event_study.R", echo = TRUE)
source("C:/Repositories/white-bowblis-nhmc/regressions/sensitivity_analysis.R", echo = TRUE)
source("C:/Repositories/white-bowblis-nhmc/regressions/summary_stats.R")
View(df)
# LETS INVESTIGATE THESE CRAZY VALUES
df %>% summarise(
n_big_rn   = sum(rn_hppd   > 3,   na.rm=TRUE),
n_big_lpn  = sum(lpn_hppd  > 3,   na.rm=TRUE),
n_big_cna  = sum(cna_hppd  > 8,   na.rm=TRUE),
n_big_tot  = sum(total_hppd> 12,  na.rm=TRUE)
)
# peek at the worst
df %>%
arrange(desc(total_hppd)) %>%
select(cms_certification_number, year_month, total_hppd, rn_hppd, lpn_hppd, cna_hppd,
coverage_ratio, occupancy_rate) %>%
head(20)
source("~/.active-rstudio-document", echo = TRUE)
source("~/.active-rstudio-document", echo = TRUE)
source("C:/Repositories/white-bowblis-nhmc/regressions/twfe_tables.R", encoding = 'ASCII', echo = TRUE)
source("C:/Repositories/white-bowblis-nhmc/regressions/twfe_tables.R", encoding = 'ASCII', echo = TRUE)
source("C:/Repositories/white-bowblis-nhmc/regressions/twfe_tables.R", encoding = 'ASCII', echo = TRUE)
source("C:/Repositories/white-bowblis-nhmc/regressions/twfe_tables.R", echo = TRUE)
source("C:/Repositories/white-bowblis-nhmc/regressions/twfe_event_study.R", echo = TRUE)
gc()
source("C:/Repositories/white-bowblis-nhmc/regressions/robustness_checks.R", echo = TRUE)
source("C:/Repositories/white-bowblis-nhmc/regressions/twfe_tables.R", echo = TRUE)
source("C:/Repositories/white-bowblis-nhmc/regressions/twfe_tables.R")
source("C:/Repositories/white-bowblis-nhmc/regressions/twfe_tables.R")
source("C:/Repositories/white-bowblis-nhmc/regressions/twfe_tables.R")
source("C:/Repositories/white-bowblis-nhmc/regressions/twfe_tables.R")
View(df)
df %>%
distinct(cms_certification_number, treatment) %>%
filter(treatment == 1) %>%
distinct(cms_certification_number) %>%
nrow()
library(dplyr)
df %>%
distinct(cms_certification_number, treatment) %>%
filter(treatment == 1) %>%
distinct(cms_certification_number) %>%
nrow()
